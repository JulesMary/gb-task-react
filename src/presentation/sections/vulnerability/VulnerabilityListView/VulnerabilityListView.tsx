import { ReactElement } from "react";
import { useVulnerabilities } from "../../../hooks";
import { ErrorMessage, Table } from "../../../components";

const VulnerabilityListView = (): ReactElement | null => {
  const { data: vulnerabilities, isLoading, error } = useVulnerabilities();
  return vulnerabilities ? (
    <Table
      columnNames={[
        { key: "oid", label: "ID" },
        { key: "name", label: "Vulnerability" },
        { key: "severity", label: "Severity" },
      ]}
      dataRows={vulnerabilities}
      fileName={"Vulnerabilities"}
    />
  ) : isLoading ? (
    <p>Vulnerabilities are loading</p>
  ) : error ? (
    <ErrorMessage message={error.message} />
  ) : null;
};

export { VulnerabilityListView };
